set enable_seqscan to off;
set enable_seqscan to on;

CREATE EXTENSION  pg_trgm;

SELECT * FROM accounts WHERE screen_name LIKE '%ldonaldt%';


SELECT * FROM accounts WHERE screen_name = 'realDonaldTrump';


-- ver1 many seconds
SELECT tweets.content, null as col2 FROM tweets 
WHERE to_tsvector('english', tweets.content) @@ to_tsquery('John | Oliver')
UNION ALL
SELECT accounts.name, accounts.description FROM accounts 
WHERE to_tsvector('english', accounts.name || ' ' || accounts.description) @@ to_tsquery('John | Oliver')
ORDER BY tweets.retweet_count


-- ver2 652ms
SELECT * FROM tweets 
JOIN accounts ON tweets.author_id=accounts.id
WHERE to_tsvector('english', accounts.name || ' ' || accounts.description) @@ to_tsquery('John | Oliver')
AND to_tsvector('english', tweets.content) @@ to_tsquery('John | Oliver')
ORDER BY tweets.retweet_count DESC


-- ver3
SELECT * FROM tweets
JOIN accounts ON tweets.author_id=accounts.id
WHERE to_tsvector('english', tweets.content) @@ to_tsquery('John | Oliver')
UNION
SELECT * FROM tweets 
JOIN accounts ON tweets.author_id=accounts.id 
WHERE to_tsvector('english', accounts.name || ' ' || accounts.description) @@ to_tsquery('John | Oliver')
-- ORDER BY tweets.retweet_count DESC



SELECT * FROM tweets 
WHERE tweets.author_id = 



SELECT * FROM pg_stat_activity WHERE state = 'active';


SELECT pg_terminate_backend(19476);



